---
title: Restricting access to a function
description: This page explains how to restrict access to a function
excerpt: |
  This page explains how to restrict access to a function
keywords: cloud computing, scaleway, serverless, functions, namespace, manage
dates:
  validation: 2021-05-26
  posted: 2021-05-26
---

This page shows you how to restrict access to your container by making it private, thus preventing unauthorized launching of it. Contrary to private dunctions, private containers need to be configured to prevent unauthenticated requests to access the container.

<Message type="important">

Be careful when you schedule automatic automatic launching of private containers, as CRON jobs are not yet able to start private containers.

</Message>


<Message type="requirement">

  - You have an account and are logged into the [Scaleway Console](https://console.scaleway.com)
  - You have generated a Scaleway [API key](https://www.scaleway.com/en/docs/console/my-project/how-to/generate-api-key/)
  - You have either `curl`, [Postman](https://www.postman.com/), [Talend API tester](https://chrome.google.com/webstore/detail/talend-api-tester-free-ed/aejoelaoggembcahagimdiliamlcdmfm) or any tool to send HTTP requests

</Message>

## Generating a JWT token

Privacy works with JWT tokens. A JWT Token can be retrieved from the API-endpoint `GET /issue-jwt`. Depending on the parameters, a JWT token can be valid for either a function, a container, or a namespace:

* `/issue-jwt?namespace_id=1`: issues JWT valid for all functions inside namespace with ID 1.
* `/issue-jwt?function_id=1`: issues JWT valid only for function with id 1.

<Message type="note">

You may (optional) provide an expiration date (formatted `yyyy-mm-ddT00:00:00Z`) for the token. 
For example: `/issue-jwt?expires_at=2022-01-02T00:00:00Z&namespace_id=1` will generate a token, valid for all functions and containers inside Namespace with id 1, and this token will be valid until January 2nd 2022.

</Message>

The token will have the following claims:

```yaml
{
 "application_claim": [
   {
     "namespace_id": "string",
     "container_id": "string" // optional: id of the container
   }
 ]
}
```

<Message type="important">

* Tokens are not stored by Scaleway and can not be retrieved if lost (but new tokens can be generated).
* Token revocation is not yet supported, the best way to reset the tokens is to destroy and recreate the namespaces and all of its functions.

</Message>

### Using curl

Use the following commnand to issue a JWT token for your Namespace from the command line using cURL: 

```sh
curl --location --request GET 'https://api.scaleway.com/functions/v1beta1/regions/fr-par/issue-jwt?namespace_id={your_namespace_id}&expires_at=2022-06-22T00%3A00%3A00Z' --header 'X-Auth-Token: {your_scaleway_API_key'}
```

### Using an API Tester (Talend API Tester)

The following steps are designed for [Talend API tester](https://chrome.google.com/webstore/detail/talend-api-tester-free-ed/aejoelaoggembcahagimdiliamlcdmfm). 

1. Specify the `GET` method.
2. Enter the API URL. 
    * For Namespaces:
      ```
      https://api.scaleway.com/functions/v1beta1/regions/fr-par/issue-jwt?namespace_id={your_namespace_id}&expires_at={expiration_date}
      ```
    * For Containers:
      ```
      https://api.scaleway.com/functions/v1beta1/regions/fr-par/issue-jwt?container_id={your_container_id}&expires_at={expiration_date}
      ```
3. Add a `X-Auth-Token` header with your Scaleway API key as value.
4. Send the request.
5. Copy the returned token.

<Lightbox src="scaleway-talend-container.png" alt="" />

## Using your token

The Scaleway API will set the following environment variables, which you can use in your application to validate incoming requests (token provided by our APIs):

* `SCW_PUBLIC`: true or false based on your privacy settings
* `SCW_PUBLIC_KEY`: PEM-encoded public Key used to decrypt tokens
* `SCW_NAMESPACE_ID`: Current Namespace ID
* `SCW_APPLICATION_ID`: Current Container ID

As described above, tokens generated from the Scaleway API will contain either namespace id or application id in its claims, so you may verify it's validity (after decrypting the JWT with the inject `SCW_PUBLIC_KEY`).